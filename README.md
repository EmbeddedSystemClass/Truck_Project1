<h1>Truck_Project1</h1>
<br />
Truck_Project1 is an automotive SCADA system which uses a Xilinx Spartan-3E to <br />
monitor real-time data, a STM32F100RB to handle a keypad and route message<br />
traffic, and a TS-7200/7800 to do I/O (turning on and off lights and reading switches).<br />
The STM32F100RB (STM32) will route message traffic to and from the FPGA, the <br />
TS-7200 and handle the keypad input.<br />
![System Diagram](Images/System_Diagram.JPG)<br />
<br />
A Windows 10 TCP client runs on a laptop and the VGA port is connected to an external 8"<br />
monitor in the dash as the UI<br />
Because the fact that the STM32 has no ethernet connection, and only communicates with<br />
the TS-7200 via a serial port, the message passing gets really complicated.<br />
Add to that, the fact that I want to be able to send messages using the keypad as well as<br />
the Windows client to the TS-7200.<br />
<h2>Using the keypad</h2>
The keypad buttons, for now, do the basic functions I need:<br />
<li> '1' - start engine</li>
<li> '2' - stop engine</li>
<li> '3' - brights</li>
<li> '4' - cooling fan</li>
<li> '5' - heater blower</li>
<li> '6' - running lights</li>
<li> '7' - headlamps</li>
<li> '8' - wipers</li>
<li> '9' - not used</li>
<li> '0' - not used</li>
Note: when you press '1' to start the engine, it only powers the relays for the ignition,<br />
fuel pump, and completes a circuit to a button on the dash to power the starter solinoid.<br />
The, the code in the TS-7200 only gives you 10 seconds to start the engine. After that,<br />
the starter solinoid is disabled.<br />
The 'stop engine' button (2) will turn off the ignition and fuel pump<br />
The keys: A->D navigate the bottom 10 buttons on the windows client starting with 'Start Engine'<br />
going down to 'Settings Three', then up to 'Play List' and then down to 'Settings Four'.<br />
The system will operate without the laptop, but you can only use the numbered buttons on<br />
the keypad. The messages generated by the lettered buttons are routed to the Windows client<br />
The buttons labeled 'Test Ports', 'Settings One/Two/Three/Four' call up child dialogs that<br />
send messages to the TS-7200. The text on the button and the message it sends can be edited<br />
by changing xml files.<br />
The messages can be found in https://github.com/sunbelt56/Truck_Project1/mytypes.h<br />
<h2> The Xilinx processor</h2>
I use a Spartan-3E Xilinx FPGA board to monitor real-time data like engine RPM,MPH. It sends<br />
data to the STM32 over a parallel port. The STM32 sends data to the FPGA board over a<br />
RS-232 port and uses handshaking signal.<br />

There will also be a task to read the ADC's which measure temp sensors and the oil pressure<br />
(among other things like the photodiode behind the windshield).<br />
The FPGA has 2 serial ports (transmit only) that send rpm & mph data to a couple of off-the-<br />
shelf 4 digit LED's that will be on the dashboard. The FPGA also sends the rpm & mph data to<br />
the PIC via the serial port.<br />



